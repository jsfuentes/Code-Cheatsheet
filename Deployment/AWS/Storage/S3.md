#S3(Simple Storage Service)

Object Storage

Basically nice http filesystem as a service

Buckets that can be accessed over https with uri like https://s3.us-east-2.amazonaws.com/jsfuentes-test/JorgeFuentes_Nov2018.pdf

Can configure access, default private

Uses:

- store files, images, videos, etc 
- could be used as a ghetto key value store or ghetto GitHub
- can serve as a static web site hosting

## Creation

[Nice coursera Overview](https://www.coursera.org/learn/aws-fundamentals-going-cloud-native/lecture/vv0yw/amazon-s3-demonstration)

Make new bucket give unique name, create bucket, super ez, 

### CLI

`aws s3 sync . s3://mybucket`

## Publically Accessible

make public, can just follow link to object ez ezezezezezezz

Add CORS policy to allow clients to access public buckets, or create an endpoint to create signed urls to access specific resources

```xml
<?xml version="1.0" encoding="UTF-8"?>
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
<CORSRule>
    <AllowedOrigin>*</AllowedOrigin>
    <AllowedMethod>GET</AllowedMethod>
    <MaxAgeSeconds>3000</MaxAgeSeconds>
    <AllowedHeader>*</AllowedHeader>
</CORSRule>
</CORSConfiguration>
```

## Static Website Hosting

1) Set to publically accessible in the bucket policy

- policy type → S3

- Effect → Allow

- Principal → *

- Actions → GetObject

- Amazon Resource Number (ARN) → Copy “arn” from permissions tab add /* or path

  ```json
  {
    "Id": "Policy1567137118824",
    "Version": "2012-10-17",
    "Statement": [
      {
        "Sid": "Stmt1567137117737",
        "Action": [
          "s3:GetObject"
        ],
        "Effect": "Allow",
        "Resource": "arn:aws:s3:::ecstatic-iframe-plugin/*",
        "Principal": "*"
      }
    ]
  }
  ```

2) Go to Properties tab of bucket and turn on server web hosting set both index and error to index.html

- You need index.html in EACH subfolder and path requests will route to that index.html
- You will get a http url

3) To setup https, you use Cloudfront *look at Cloudfront.md*

- ? You might be able to just use cloudfront and skip step 2 and the weird fact you must be in the root folder allowing you to not use the aws cli

*Extra: Look at codebuild.md to get a built react app or github updates into the S3, use the AWS cli to get the artifact in the root*